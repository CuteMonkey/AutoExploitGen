#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <unistd.h>
#include "s2e.h"

int main(int argc, char **argv)
{

  if(argc < 4)
  {
    printf("error\n");
    return 0;
  }
  printf("%s\n",argv[1]);
  printf("%s\n",argv[2]);
  printf("%d\n",strlen(argv[3]));


  setenv(argv[2], argv[3], 1);
  char *ptr = getenv(argv[2]);
  s2e_make_symbolic(ptr, strlen(argv[3]), "env");
  //s2e_make_symbolic(ptr, strlen(argv[3]), "env", 0);

  int pid = fork();
   
  if(pid == 0 )
  {
    execl(argv[1], argv[1], NULL);
  }
  else
  {
    wait();
    s2e_kill_state(0, "over");
  }

  return 0;
}
