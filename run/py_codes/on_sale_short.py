from prototype import *
import time

start_time = time.time()

home_dir = '/home/chengte'
target_root = 'targets/cb-multios'

#prepare stage
open_qemu_mode('init')
scp_guest('crax_exploit/guest_need', True)
scp_guest('crax_exploit/guest_need2', True)
ssh_guest('cd ' + home_dir + '/guest_need && make && cd ' + home_dir + '/guest_need2 && make && cd ' + home_dir + ' && mkdir cb-multios')
scp_guest(target_root + '/build', True)
scp_guest(target_root + '/processed-challenges/On_Sale', True)
ssh_guest('mv build cb-multios && mv On_Sale cb-multios')
vm_name = 'on_sale_t_s'
control_qemu('savevm ' + vm_name)
control_qemu('quit')

print('Execution time:', time.time() - start_time, 'second(s)')
